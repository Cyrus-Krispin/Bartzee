<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

<link rel="stylesheet" href="../css/bootstrap.min.css">
<link rel="stylesheet" href="../css/styles.css">
<link rel="stylesheet" href="../css/dropdown.css">
<link rel="stylesheet" href="../css/home.css">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" type="text/css"
    href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="shortcut icon" href="#">



<!-- Top Navigation Bar if user is not logged in-->
<div class="container" id="div-main">
    <div class="row">
        <div class="col-md-2">
            <div class="logo">
                <a class="navbar-brand mt-2" href="/"><img src="../orbitalLogo.png"
                        style="width:200px;height:60px;"></a>
            </div>
        </div>


        <div class="col-md-7">

            <form id="search-form">
                <div class="input-group" style="height:45px;">
                    <div class="dropdown">
                        <button class="btn btn-outline-secondary" style="height:45px;">All <i class="fa fa-caret-down"
                                aria-hidden="true"></i></button>
                        <div class="dropdown-content">
                            <a href="/">All</a>
                            <a href="/search/Electronics">Electronics</a>
                            <a href="/search/Stationary">Stationary</a>
                            <a href="/search/Sport Equipments">Sport Equipments</a>
                            <a href="/search/Gaming">Gaming</a>
                            <a href="/search/Clothing">Clothing</a>
                            <a href="/search/Student Resources">Student Resources</a>
                            <a href="/search/Books">Books</a>
                            <a href="/search/Room Decor">Room Decor</a>
                            <a href="/search/Hardware">Hardware</a>
                            <a href="/search/Household">Household</a>
                            <a href="/search/Others">Others</a>
                        </div>
                    </div>
                    <input type="search" class="form-control" id="searchBar">
                    <button class="btn btn-warning" type="button" id="searchBtn" onclick="search()">&nbsp;<i
                            class="fa fa-search" aria-hidden="true"></i>&nbsp;</button>
                </div>
            </form>

        </div>


        <div class="col-md-2">
            <div class="header-buttons">
                <% if (user) { %>
                    
                    <a href="/cart"><button class="btn btn-outline-warning btn-lg" type="button" style="width: 30%;"><i
                                class="fa fa-shopping-cart"></i>&nbsp;&nbsp;Cart&nbsp;&nbsp;<span
                                class="badge bg-warning ms-1">
                                <%= count %>
                            </span></button></a>

                    <div class="dropdown">
                        <% if(user.image.contentType) {%>
                            
                        <button class="btn btn-outline-secondary btn-lg"><img src="data:image/<%= user.image.contentType%>;base64,
                            <%=user.image.data.toString('base64')%>" style="height:30px; width:30px; border-radius: 100%; border: 2px solid #222831;">&nbsp;Hi <%= user.name%> <i class="fa fa-caret-down"
                                    aria-hidden="true"></i></button>
                        <% } else { %>
                            <button class="btn btn-outline-secondary btn-lg"><i class="fa fa-user-circle-o"
                                aria-hidden="true"></i>&nbsp;Hi <%= user.name%> <i class="fa fa-caret-down"
                                        aria-hidden="true"></i></button>
                        <% } %>
                        <div class="dropdown-content">
                            <a class="dropdown-item" href="/profile"><i class="fa fa-user" aria-hidden="true"></i>
                                &nbsp;Profile</a>
                            <a class="dropdown-item" href="/users/logout"><i class="fa fa-sign-out"
                                    aria-hidden="true"></i>
                                &nbsp;Logout</a>
                        </div>
                    </div>


                    <% } else { %>
                        <a href="/users/login"><button class="btn btn-outline-warning btn-lg" type="button"
                                style="width: 30%;"><i class="fa fa-shopping-cart"></i>&nbsp;&nbsp;Cart&nbsp;&nbsp;
                                <span class="badge bg-warning ms-1">
                                    <%= count %>
                                </span></button></a>

                        <a href="/users/login"><button class="btn btn-outline-secondary btn-lg" type="button"
                                style="width: 30%;"><i class="fa fa-sign-in"></i>&nbsp;&nbsp;Login</button></a>
                        <% } %>
            </div>

        </div>
    </div>
</div>


<!-- Menu Bar -->
<nav class="navbar navbar-expand-lg" style="background-color: #47B5FF;">
    <div class="container-fluid">

        <div class="collapse navbar-collapse" id="navbarText">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item" style="padding-right: 10px;">
                    <a class="nav-link" href="/" style="color: #222831;">Home</a>
                </li>
                <% if (user) { %>
                    <li class="nav-item" style="padding-right: 10px;">
                        <a class="nav-link" href="/productReg" style="color: #222831;">Sell Your Item</a>
                    </li>
                    <li class="nav-item" style="padding-right: 10px;">
                        <a class="nav-link" href="/sellCart" style="color: #222831;">Your Items</a>
                    </li>
                    <% } else { %>
                        <li class="nav-item" style="padding-right: 10px;">
                            <a class="nav-link" href="/users/login" style="color: #222831;">Sell Your Item</a>
                        </li>
                        <li class="nav-item" style="padding-right: 10px;">
                            <a class="nav-link" href="/users/login" style="color: #222831;">Your Items</a>
                        </li>
                        <% } %>
                
            </ul>
            <span class="navbar-text">
                <div class="dropdown" style="float:right;">
                    <button class="btn bg-transparent dropdown-toggle" type="button" id="dropdownMenuButton1"
                        data-bs-toggle="dropdown" aria-expanded="false" style="color:white; ">
                        <i class="fa fa-bell-o fa-lg" aria-hidden="true"></i>
                        <% if(msg) {%>
                        <span class="badge rounded-pill bg-danger badge-dot"><%= msg.length %></span>
                        <% } else { %>
                            <span class="badge rounded-pill bg-danger badge-dot">0</span>
                        <% } %>
                    </button>
                    <div class="dropdown-content-notif" style="border-radius: 30px;">
                        <div style="text-align: center; padding-top: 10px;"><b>Notifications</b></div>
                        <br>
                        <% for (var i in msg) {%>
                            <a class="dropdown-item" href="#">â€¢ <%= msg[i].notif %>
                                    <br>
                                    <div style="text-align: right;"><small>
                                            <%= msg[i].date.toLocaleDateString() %>
                                        </small></div>
                            </a>
                            <hr>
                            <% } %>
                    </div>
                </div>
            </span>
        </div>
    </div>
</nav>

<% if (search) { %>
    <div style="padding-left: 10px;">
        <u>
            <h6>Search results for : <b>
                    <%= search %>
                </b></h6>
        </u>
    </div>
    <% } %>


        <script>
            var searchQuery = document.getElementById('searchBar').value;
            var inp = document.getElementById("searchBar");

            inp.addEventListener("keyup", function (event) {
                if (event.keyCode === 13) {
                    event.preventDefault();
                    document.getElementById("searchBtn").click();
                }
            });

            function search(event) {
                var searchQuery = document.getElementById('searchBar').value;
                if (searchQuery.trim().length == 0) {
                    event.preventDefault();
                } else {
                    window.location.href = `/search/${searchQuery}`;
                }

            }

        </script>